!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.editor=e()}}(function(){return function e(t,n,o){function a(s,r){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n?n:e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)a(o[s]);return a}({1:[function(e,t,n){function o(e,t,n,o){function a(e,t,n,o){return 20>e?t&n|~t&o:40>e?t^n^o:60>e?t&n|t&o|n&o:t^n^o}function i(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function s(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}function r(e,t){return e<<t|e>>>32-t}function l(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var n=[80],o=1732584193,l=-271733879,c=-1732584194,d=271733878,u=-1009589776,f=0;f<e.length;f+=16){for(var p=o,h=l,m=c,g=d,v=u,b=0;80>b;b++){16>b?n[b]=e[f+b]:n[b]=r(n[b-3]^n[b-8]^n[b-14]^n[b-16],1);var y=s(s(r(o,5),a(b,l,c,d)),s(s(u,n[b]),i(b)));u=d,d=c,c=r(l,30),l=o,o=y}o=s(o,p),l=s(l,h),c=s(c,m),d=s(d,g),u=s(u,v)}return[o,l,c,d,u]}function c(e){for(var t=[],n=(1<<o)-1,a=0;a<e.length*o;a+=o)t[a>>5]|=(e.charCodeAt(a/8)&n)<<32-o-a%32;return t}function d(e,t){var n=c(e);n.length>16&&(n=l(n,e.length*o));for(var a=[16],i=[16],s=0;16>s;s++)a[s]=909522486^n[s],i[s]=1549556828^n[s];var r=l(a.concat(c(t)),512+t.length*o);return l(i.concat(r),672)}function u(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",a=0;a<4*e.length;a+=3)for(var i=(e[a>>2]>>8*(3-a%4)&255)<<16|(e[a+1>>2]>>8*(3-(a+1)%4)&255)<<8|e[a+2>>2]>>8*(3-(a+2)%4)&255,s=0;4>s;s++)o+=8*a+6*s>32*e.length?n:t.charAt(i>>6*(3-s)&63);return o}function f(e,t){return u(d(e,t))}return n||(n="="),o||(o=8),f(e,t)}t.exports=o},{}],2:[function(e,t,n){"use strict";function o(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function a(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;10>n;n++)t["_"+String.fromCharCode(n)]=n;var o=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==o.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(i){return!1}}var i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=a()?Object.assign:function(e,t){for(var n,a,r=o(e),l=1;l<arguments.length;l++){n=Object(arguments[l]);for(var c in n)i.call(n,c)&&(r[c]=n[c]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(n);for(var d=0;d<a.length;d++)s.call(n,a[d])&&(r[a[d]]=n[a[d]])}}return r}},{}],3:[function(e,t,n){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function r(e){return void 0===e}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,n,o,i,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],r(n))return!1;if(a(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,i=new Array(o-1),l=1;o>l;l++)i[l-1]=arguments[l];n.apply(this,i)}else if(s(n)){for(o=arguments.length,i=new Array(o-1),l=1;o>l;l++)i[l-1]=arguments[l];for(c=n.slice(),o=c.length,l=0;o>l;l++)c[l].apply(this,i)}return!0},o.prototype.addListener=function(e,t){var n;if(!a(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var n;n=r(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!a(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},o.prototype.removeListener=function(e,t){var n,o,i,r;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,o=-1,n===t||a(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(r=i;r-- >0;)if(n[r]===t||n[r].listener&&n[r].listener===t){o=r;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],a(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?a(e._events[t])?1:e._events[t].length:0}},{}],4:[function(e,t,n){(function(e){"use strict";function n(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=a.createClass({displayName:"ComboBox",getInitialState:function(){return{show:!1,position:{x:0,y:0}}},componentDidMount:function(){window.addEventListener("click",this.close)},componentWillUnmount:function(){window.removeEventListener("click",this.close)},open:function(e){this.setState({show:!0,position:e})},close:function(){this.state.show&&this.setState({show:!1})},toggle:function(e){this.setState({show:!this.state.show,position:e})},render:function(){var e=this.props,t=e.className,i=e.style,s=n(e,["className","style"]);return i=i||{},this.state.show?i.display="":i.display="none",this.state.position&&(i.left=this.state.position.x,i.top=this.state.position.y),a.createElement("div",o({style:i,className:"combobox"+(t?" "+t:"")},s),this.props.children)}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){(function(e){"use strict";function n(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var o="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,a=o.createClass({displayName:"Dialog",getInitialState:function(){return{show:!1}},componentDidMount:function(){window.addEventListener("click",this.close)},componentWillUnmount:function(){window.removeEventListener("click",this.close)},open:function(){this.setState({show:!0})},close:function(){this.state.show&&this.setState({show:!1})},toggle:function(){this.setState({show:!this.state.show})},handleMouseDown:function(e){e=e||event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},render:function(){var e=this.props,t=(n(e,[]),e.className),a=e.buttons,i=e.title,s=e.style,r=e.width,l=e.height,s=s?s:{};r&&(s.width=r,s.marginLeft=-r/2),l&&(s.height=l),s.display=this.state.show?"":"none";var c="dialog"+(t?" "+t:"");return o.createElement("div",{className:"dialog-container",ref:"root",onMouseDown:this.handleMouseDown},o.createElement("div",{className:c,ref:"dialog",style:s},o.createElement("div",{className:"dialog-header",ref:"header"},o.createElement("a",{className:"dialog-close",onClick:this.props.onClose}),o.createElement("h3",{className:"dialog-title"},i)),o.createElement("div",{className:"dialog-body",ref:"body"},this.props.children),o.createElement("div",{className:"dialog-footer",ref:"footer"},a.map(function(e,t){return o.createElement("a",{className:"dialog-button",key:t,"data-name":e.name,onClick:e.onClick},e.content)}))),o.createElement("div",{className:"dialog-backdrop",ref:"backdrop",style:{display:this.state.show?"":"none"}}))}});t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,t,n){(function(e){"use strict";function n(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=a.createClass({displayName:"Dropdown",getInitialState:function(){return{show:!1,position:{x:0,y:0}}},componentDidMount:function(){window.addEventListener("click",this.close)},componentWillUnmount:function(){window.removeEventListener("click",this.close)},open:function(e){this.setState({show:!0,position:e})},close:function(){this.state.show&&this.setState({show:!1})},toggle:function(e){this.setState({show:!this.state.show,position:e})},render:function(){var e=this.props,t=e.className,i=e.style,s=n(e,["className","style"]);return i=i||{},this.state.show?i.display="":i.display="none",this.state.position&&(i.left=this.state.position.x,i.top=this.state.position.y),a.createElement("div",o({style:i,className:"dropdown"+(t?" "+t:"")},s),a.createElement("div",{className:"dropdown-caret"}),this.props.children)}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,o=n.createClass({displayName:"TabGroup",getInitialState:function(){return{tabIndex:0}},setTabIndex:function(e){this.setState({tabIndex:e})},getTabIndex:function(){return this.state.tabIndex},handleClick:function(e){e=e||event;var t=e.target||e.srcElement,n=parseInt(t.getAttribute("data-index"));this.setTabIndex(n),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},render:function(){var e=this.state.tabIndex,t=this.props.tabs,o=t[e].component,a=this.handleClick;return n.createElement("div",{className:"tab-group"},n.createElement("ul",{className:"tab-nav"},t.map(function(t,o){return n.createElement("li",{key:o,className:"tab-item"+(e==o?" active":"")},n.createElement("a",{"data-index":o,className:"tab-text",onClick:a},t.title))})),n.createElement("div",{className:"tab-content"},o))}});t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("react-dom"),i=e("../../utils/EditorSelection"),s=e("../../utils/EditorDOM"),r=e("../../utils/EditorResize.react"),l=o.createClass({displayName:"EditorContentEditableDiv",getInitialState:function(){return{content:""}},componentDidMount:function(e){window.addEventListener("mousedown",this.handleWindowMouseDown)},componentWillUnmount:function(e){window.removeEventListener("mousedown",this.handleWindowMouseDown)},componentWillUpdate:function(e){i.cloneRange()},componentDidUpdate:function(e){i.cloneRange()},getContent:function(){var e=a.findDOMNode(this.refs.edit);return e.innerHTML},setContent:function(e){this.setState({content:e});var t=a.findDOMNode(this.refs.edit);t.innerHTML=e},getName:function(){return"div"},handleWindowMouseDown:function(e){e=e||event;var t=e.target||e.srcElement,n=t.tagName.toUpperCase(),o=["TEXTAREA","INPUT","SELECT","OPTIONS"];return-1!=o.indexOf(n)?void console.log("in FormControls"):void i.clearRange()},handleMouseDown:function(e){i.clearRange(),window.addEventListener("mouseup",this.handleMouseUp),s.stopPropagation(e)},handleMouseUp:function(e){i.createRange(),window.removeEventListener("mouseup",this.handleMouseUp),this.props.onRangeChange&&this.props.onRangeChange(e),s.stopPropagation(e)},setResizeTarget:function(e){this.refs.resize.setTarget(e)},clearResizeTarget:function(){this.refs.resize.clearTarget()},getEditorRange:function(){return a.findDOMNode(this.refs.edit)},render:function(){return o.createElement("div",{className:"editor-contenteditable-div"},o.createElement(r,{ref:"resize"}),o.createElement("div",{className:"editable-range",ref:"edit",onMouseUp:this.handleMouseUp,onMouseDown:this.handleMouseDown,contentEditable:!0,dangerouslySetInnerHTML:{__html:this.state.content}}))}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/EditorDOM":24,"../../utils/EditorResize.react":27,"../../utils/EditorSelection":28,"react-dom":void 0}],9:[function(e,t,n){(function(n){"use strict";function o(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,s=e("react-dom"),r=e("../../constants/EditorConstants"),l=(r.EditorIconTypes,e("../../utils/EditorHistory")),c=e("../../utils/EditorSelection"),d=e("../../utils/EditorDOM"),u=e("../../utils/EditorTimer"),f=e("../plugins/ColorDropdown.react"),p=e("../plugins/FormulaDropdown.react"),h=e("../plugins/TablePickerDropdown.react"),m=e("../plugins/FontSizeComboBox.react"),g=e("../plugins/FontFamilyComboBox.react"),v=e("../plugins/ParagraphComboBox.react"),b=e("../plugins/EmotionDialog.react"),y=e("../plugins/SpecialCharsDialog.react"),x=e("../plugins/ImageDialog.react"),w=e("../core/EditorToolbar.react"),E=e("../core/EditorTextArea.react"),k=e("../core/EditorContentEditableDiv.react"),C=MathQuill?MathQuill.getInterface(2):null,N=null,S=0,P=i.createClass({displayName:"EditorCore",getInitialState:function(){return{editorState:{icon:"source",showHtml:!1,icons:{forecolor:{color:"transparent",icon:"forecolor"},backcolor:{color:"transparent",icon:"backcolor"},fontsize:{value:"3",icon:"fontsize"},paragraph:{value:"p",icon:"fontsize"},fontfamily:{value:"宋体, SimSun",icon:"fontfamily"},indent:{active:!1,icon:"indent"},outdent:{active:!0,icon:"outdent"}}},defaultValue:this.props.defaultValue?this.props.defaultValue:"<p>This is an Editor</p>",value:this.props.value}},componentDidMount:function(){l.clear(),this.setContent(this.state.value||this.state.defaultValue);var e=s.findDOMNode(this.refs.editarea);e.addEventListener("keydown",this.handleKeyDown),e.addEventListener("keyup",this.handleKeyUp);var t=this.props.onEditorMount;setTimeout(t,10)},componentDidUpdate:function(){var e=this.state.editorState;switch(e.icon){case"source":e.content&&this.setContent(e.content);break;case"cleardoc":e.content&&this.setContent(e.content)}},componentWillUnmont:function(){var e=s.findDOMNode(this.refs.editarea);e.removeEventListener("keydown",this.handleKeyDown),e.removeEventListener("keyup",this.handleKeyUp)},handleKeyDown:function(e){e=e||event;var t=e.target||e.srcElement;if(t.className&&-1!=t.className.indexOf("editor-contenteditable-div")){var n=e.keyCode||e.which,o=this.autoSave;e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(0==l.getCommandStack().length&&(o(),S=0),clearTimeout(N),N=u.setTimeout(function(){var e=u.setInterval(function(){o(),S=0,u.clearInterval(e)},300)},200),lastKeyCode=n,S++,S>=maxInputCount&&(o(),S=0))}d.stopPropagation(e)},handleKeyUp:function(e){e=e||event;var t=e.target||e.srcElement;if(t.className&&-1!=t.className.indexOf("editor-contenteditable-div")){e.keyCode||e.which;!(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)}d.stopPropagation(e)},handleFocus:function(e){this.props.onFocus&&this.props.onFocus(e,this.findDOMNode("root")),d.stopPropagation(e)},handleClick:function(e){d.stopPropagation(e)},exchangeRangeState:function(e){var t=c.getRangeState();for(var n in t)if(e.icons[n]){switch(n){case"forecolor":case"backcolor":e.icons[n].color=t[n].color;break;case"paragraph":case"fontfamily":case"fontsize":e.icons[n].value=t[n].value}e.icons[n].active=t[n].active}else e.icons[n]=t[n];return e},handleRangeChange:function(e){if(e=e||event,!e||"blur"!=e.type){var t=e?e.target||e.srcElement:null,n=c.getSelection();if(n&&n.rangeCount>0){var o=this.state.editorState;o=this.exchangeRangeState(o),this.setState({editorState:o}),this.refs.editarea&&this.refs.editarea.clearResizeTarget&&this.refs.editarea.clearResizeTarget()}else if(t){var a=t.tagName.toUpperCase();switch(a){case"IMG":this.refs.editarea&&this.refs.editarea.setResizeTarget&&this.refs.editarea.setResizeTarget(t)}}}},handleToolbarIconClick:function(e,t){e=e||event;var n=e.target||e.srcElement,o=s.findDOMNode(this.refs.root),a=d.getOffsetRootParentPosition(n,o),i=this.handleRangeChange,r=s.findDOMNode(this.refs.editarea);this.refs.editarea.getEditorRange&&(r=this.refs.editarea.getEditorRange());var f=this.state.editorState;switch(c.cloneRange(),c.storeRange(),this.closeAllOpenDialog(t.icon),c.restoreRange(),t.icon){case"source":f.showHtml=!f.showHtml,t.active=f.showHtml,f.content=this.refs.editarea.getContent();break;case"undo":l.undo();break;case"redo":l.redo();break;case"removeformat":l.execCommand(t.icon,!1,null),c.storeRange();for(var p=c.getSpanNodes(),h=0;h<p.length;h++)switch(p[h].className){case"font-border":for(var m=p[h],g=m.parentNode,v=m.nextSibling||m,b=m.childNodes.length,y=0;b>y;y++)g.insertBefore(m.childNodes[y].cloneNode(),v);g.removeChild(p[h]);break;case"emphasis":for(var m=p[h],g=m.parentNode,v=m.nextSibling||m,b=m.childNodes.length,y=0;b>y;y++)g.insertBefore(m.childNodes[y].cloneNode(),v);g.removeChild(p[h])}c.restoreRange();break;case"bold":case"italic":case"underline":case"strikethrough":case"subscript":case"superscript":case"insertorderedlist":case"insertunorderedlist":case"selectall":case"justifyleft":case"justifyright":case"justifycenter":case"indent":case"outdent":l.execCommand(t.icon,!1,null);break;case"touppercase":case"tolowercase":c.storeRange();for(var x=c.getTextNodes(),h=0;h<x.length;h++){var w=x[h].childNode,E=x[h].startOffset,k=x[h].endOffset;w.nodeValue=w.nodeValue.substring(0,E)+("touppercase"==t.icon?w.nodeValue.substring(E,k).toUpperCase():w.nodeValue.substring(E,k).toLowerCase())+w.nodeValue.substring(k,w.length)}l.execCommand(t.icon,!1,null),c.restoreRange();break;case"fontborder":for(var x=c.getTextNodes(),C=null,N=null,S=0,P=0,h=0;h<x.length;h++){var w=x[h].childNode,E=x[h].startOffset,k=x[h].endOffset,T=w.cloneNode(),M=T.nodeValue.substring(0,E),O=T.nodeValue.substring(k,T.length),R=T.nodeValue.substring(E,k),D=null,L=x[h].childNode.parentNode;L&&L.className&&"font-border"==L.className?(0==h&&(C=x[h].childNode,S=E),h==x.length-1&&(N=x[h].childNode,P=k)):(w.nodeValue=M,D=document.createElement("span"),D.className="font-border",D.innerHTML=R,D.style.border="1px solid #000",w.parentNode.insertBefore(D,w.nextSibling||w),""!=O&&w.parentNode.insertBefore(document.createTextNode(O),D.nextSibling),0==h&&(C=D.childNodes[0]),h==x.length-1&&(N=D.childNodes[0],P=D.childNodes[0].length))}c.addRange(C,S,N,P);for(var p=c.getSpanNodes(),h=0;h<p.length-1;h++){var m=p[h],g=p[h].parentNode;if(d.isNullOfTextNode(m.nextSibling)&&g.removeChild(m.nextSibling),m.nextSibling===p[h+1]){for(var I=p[h+1].childNodes,y=0;y<I.length;y++)m.appendChild(I[y].cloneNode());g.removeChild(p[h+1]),p[h+1]=p[h]}}l.execCommand(t.icon,!1,null);break;case"emphasis":for(var x=c.getTextNodes(),C=null,N=null,S=0,P=0,h=0;h<x.length;h++){var w=x[h].childNode,E=x[h].startOffset,k=x[h].endOffset,T=w.cloneNode(),M=T.nodeValue.substring(0,E),O=T.nodeValue.substring(k,T.length),R=T.nodeValue.substring(E,k),D=null,L=x[h].childNode.parentNode;L&&L.className&&"emphasis"==L.className?(0==h&&(C=x[h].childNode,S=E),h==x.length-1&&(N=x[h].childNode,P=k)):(w.nodeValue=M,D=document.createElement("span"),D.className="emphasis",D.innerHTML=R,w.parentNode.insertBefore(D,w.nextSibling||w),""!=O&&w.parentNode.insertBefore(document.createTextNode(O),D.nextSibling),0==h&&(C=D.childNodes[0]),h==x.length-1&&(N=D.childNodes[0],P=D.childNodes[0].length))}c.addRange(C,S,N,P);for(var p=c.getSpanNodes(),h=0;h<p.length-1;h++){var m=p[h],g=p[h].parentNode;if(d.isNullOfTextNode(m.nextSibling)&&g.removeChild(m.nextSibling),m.nextSibling===p[h+1]){for(var I=p[h+1].childNodes,y=0;y<I.length;y++)m.appendChild(I[y].cloneNode());g.removeChild(p[h+1]),p[h+1]=p[h]}}l.execCommand(t.icon,!1,null);break;case"forecolor":c.storeRange(),a.y+=a.h+5,this.refs.color.toggle(a,function(e,t){r.focus(),c.restoreRange(),l.execCommand("forecolor",!1,t),i()});break;case"backcolor":c.storeRange(),a.y+=a.h+5,this.refs.color.toggle(a,function(e,t){r.focus(),c.restoreRange(),l.execCommand("backcolor",!1,t),i()});break;case"fontsize":c.storeRange(),a.y+=a.h+5,this.refs.fontsize.toggle(a,function(e,t){r.focus(),c.restoreRange(),l.execCommand("fontsize",!1,t),i()});break;case"fontfamily":c.storeRange(),a.y+=a.h+5,this.refs.fontfamily.toggle(a,function(e,t){r.focus(),c.restoreRange(),l.execCommand("fontname",!1,t),i()});break;case"paragraph":c.storeRange(),a.y+=a.h+5,this.refs.paragraph.toggle(a,function(e,t){r.focus(),c.restoreRange();for(var n=c.getParagraphs(),o=0;o<n.length;o++)switch(n[o].tagName.toUpperCase()){case"TD":case"TH":case"DIV":for(var a=n[o].childNodes,s=document.createElement(t),d=0;d<a.length;d++)s.appendChild(a[d]);n[o].appendChild(s);break;case"P":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":var u=n[o],a=n[o].childNodes,s=document.createElement(t),f=u.parentNode;f.insertBefore(s,u.nextSibling);for(var d=0;d<a.length;d++)s.appendChild(a[d]);f.removeChild(u)}l.execCommand("paragraph",!1,t),i()});break;case"cleardoc":f.content="<p><br/></p>";break;case"horizontal":var z="<hr/><p></br></p>";if(c.range.pasteHTML)c.range.pasteHTML(z);else{var A=d.createHR(),_=d.createNodeByTag("p","<br/>");c.range.deleteContents(),c.insertNode(_),c.insertNode(A)}break;case"date":var j=(new Date).Format("yyyy-MM-dd");if(c.range.pasteHTML)c.range.pasteHTML(j);else{var U=d.createTextNode(j);c.range.deleteContents(),c.insertNode(U)}break;case"time":var z=(new Date).Format("hh:mm:ss");if(c.range.pasteHTML)c.range.pasteHTML(z);else{var U=d.createTextNode(z);c.range.deleteContents(),c.insertNode(U)}break;case"image":c.storeRange(),this.refs.image.toggle(function(e,t){if(r.focus(),c.restoreRange(),t&&t.length>0)if(c.range)if(c.range.pasteHTML)c.range.pasteHTML("<p>"+t+"</p>");else{var n=d.createNodeByTag("p",t);c.range.deleteContents(),c.insertNode(n)}else r.innerHTML+="<p>"+t+"</p>"});break;case"formula":c.storeRange(),a.y+=a.h+5,a.x-=a.w/2;var F=this;this.refs.formula.toggle(a,function(e,t,n){if(r.focus(),c.restoreRange(),t&&t.length>0){var o='<span>&nbsp;<span class="mathquill-embedded-latex" id="'+n+'"></span>&nbsp;</span>';if(c.range)if(c.range.pasteHTML)c.range.pasteHTML(o);else{var a=d.createNodeByTag("span",'&nbsp;<span class="mathquill-embedded-latex" id="'+n+'"></span>&nbsp;');c.range.deleteContents(),c.insertNode(a)}else r.innerHTML+=o;u.setTimeout(function(){F.addFormula(n,t)},200),i()}});break;case"inserttable":c.storeRange(),a.y+=a.h+5,a.x-=a.w/2,this.refs.table.toggle(a,function(e,t){r.focus(),c.restoreRange(),c.range.pasteHTML?c.range.pasteHTML(t.outerHTML):(c.range.deleteContents(),c.insertNode(t)),i()});break;case"spechars":c.storeRange(),this.refs.special.toggle(function(e,t){if(r.focus(),c.restoreRange(),c.range.pasteHTML)c.range.pasteHTML(t);else{var n=d.createTextNode(t);c.range.deleteContents(),c.insertNode(n)}i()});break;case"emotion":c.storeRange(),this.refs.emotion.toggle(function(e,t){r.focus(),c.restoreRange(),c.range.pasteHTML?c.range.pasteHTML(t.outerHTML):(c.range.deleteContents(),c.insertNode(t)),i()})}f.icons[t.icon]=t,f.icon=t.icon,c.createRange(),f=this.exchangeRangeState(f),this.setState({editorState:f}),d.stopPropagation(e)},closeAllOpenDialog:function(e){var t=["image","color","formula","table","special","emotion","fontsize","fontfamily","paragraph"],n=["forecolor","backcolor","image","emotion","spechars","inserttable","formula","paragraph","fontsize","fontfamily"];if(-1!=n.indexOf(e))for(var o=0;o<t.length;o++)this.refs[t[o]].close(),console.log("closeDialog",t[o])},addFormula:function(e,t){var n=s.findDOMNode(this.refs.editarea),o=document.getElementById(e),a={handlers:{edit:function(){}},restrictMismatchedBrackets:!0};if(null!=o||null!=C){var i=C.MathField(o,a);i.latex(t);var r=$(o);r.keydown(function(e){i.focus(),d.stopPropagation(e)}),r.keyup(function(e){i.focus(),d.stopPropagation(e)}),r.mouseup(function(e){i.focus(),d.stopPropagation(e)}),r.mousedown(function(e){d.stopPropagation(e)}),r.mousemove(function(e){d.stopPropagation(e)}),$(n).mousedown(function(e){i.blur(),d.stopPropagation(e)}),$(n).mousemove(function(e){d.stopPropagation(e)})}},autoSave:function(){l.execCommand("autosave",!1,null)},findDOMNode:function(e){var t=["root","editarea","toolbar","color"];return-1==t.indexOf(e)?{ref:null,dom:null}:{ref:this.refs[e],dom:s.findDOMNode(this.refs[e])}},setContent:function(e){var e=e||this.state.defaultValue||"";if(this.refs.editarea.setContent(e),-1!=e.indexOf("mathquill-embedded-latex")){var t=this;u.setTimeout(function(){for(var e=s.findDOMNode(t.refs.editarea),n=e.querySelectorAll(".mathquill-embedded-latex"),o=0;o<n.length;o++)if(!n[o].id){var a="mathquill-"+o+"-"+(new Date).valueOf(),i=n[o].innerHTML;n[o].id=a,t.addFormula(a,i)}},200)}},getContent:function(){return this.refs.editarea.getContent()},focusEditor:function(){var e=s.findDOMNode(this.refs.editarea);e.focus()},genEditArea:function(){var e=this.state.editorState.showHtml;return e?i.createElement(E,{ref:"editarea"}):i.createElement(k,{ref:"editarea",onRangeChange:this.handleRangeChange})},render:function(){var e=this.genEditArea(),t=this.props,n=(t.index,t.fontSize),s=t.paragraph,r=t.fontFamily,l=t.icons,c=(t.plugins,t.onBlur,t.className),d=t.id,u=(t.onFocus,t.onClick,t.onEditorMount,o(t,["index","fontSize","paragraph","fontFamily","icons","plugins","onBlur","className","id","onFocus","onClick","onEditorMount"])),E=this.state.editorState,k=l.join(" ").replace(/\|/gm,"separator").split(" ");return i.createElement("div",a({ref:"root",id:d,className:"editor-container editor-default"+(c?" "+c:""),onClick:this.handleClick,onBlur:this.handleRangeChange,onFocus:this.handleFocus},u),i.createElement(w,{ref:"toolbar",editorState:E,onIconClick:this.handleToolbarIconClick,icons:this.props.icons,paragraph:this.props.paragraph,fontsize:this.props.fontSize,fontfamily:this.props.fontFamily},i.createElement(x,{hidden:-1==k.indexOf("image"),ref:"image",uploader:this.props.plugins.image.uploader}),i.createElement(f,{hidden:-1==k.indexOf("forecolor")&&k.indexOf("forecolor"),ref:"color"}),i.createElement(p,{hidden:-1==k.indexOf("formula"),ref:"formula"}),i.createElement(h,{hidden:-1==k.indexOf("inserttable"),ref:"table"}),i.createElement(y,{hidden:-1==k.indexOf("spechars"),ref:"special"}),i.createElement(b,{hidden:-1==k.indexOf("emotion"),ref:"emotion"}),i.createElement(m,{hidden:-1==k.indexOf("fontsize"),ref:"fontsize",fontsize:this.props.fontSize,value:E.icons.fontsize?E.icons.fontsize.value:n[0].value}),i.createElement(g,{hidden:-1==k.indexOf("fontfamily"),ref:"fontfamily",fontfamily:this.props.fontFamily,value:E.icons.fontfamily?E.icons.fontfamily.value:r[0].value}),i.createElement(v,{hidden:-1==k.indexOf("paragraph"),ref:"paragraph",paragraph:this.props.paragraph,value:E.icons.paragraph?E.icons.paragraph.value:s[0].value})),e)}});t.exports=P}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../../utils/EditorDOM":24,"../../utils/EditorHistory":26,"../../utils/EditorSelection":28,"../../utils/EditorTimer":29,"../core/EditorContentEditableDiv.react":8,"../core/EditorTextArea.react":11,"../core/EditorToolbar.react":12,"../plugins/ColorDropdown.react":13,"../plugins/EmotionDialog.react":14,"../plugins/FontFamilyComboBox.react":15,"../plugins/FontSizeComboBox.react":16,"../plugins/FormulaDropdown.react":17,"../plugins/ImageDialog.react":18,"../plugins/ParagraphComboBox.react":19,"../plugins/SpecialCharsDialog.react":20,"../plugins/TablePickerDropdown.react":21,"react-dom":void 0}],10:[function(e,t,n){(function(n){"use strict";function o(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,s=e("react-dom"),r=i.createClass({displayName:"EditorIcon",componentDidMount:function(){this.updateStyle()},componentDidUpdate:function(){this.updateStyle()},updateStyle:function(){var e=s.findDOMNode(this.refs.root),t=this.props.icon;switch(this.props.icon){case"forecolor":case"backcolor":var n=this.props.color?this.props.color:"transparent";e.id=t+"_"+(new Date).valueOf();var o=e.childElementCount>0?e.children[0]:document.createElement("style");o.innerHTML=".icon-"+t+"#"+e.id+":before{content:'';border-bottom:3px solid "+n+";}",0==e.childElementCount&&e.appendChild(o)}},handleClick:function(e){e=e||event;for(var t=e.target||e.srcElement;-1==t.className.indexOf("editor-icon");)t=t.parentElement;e.target=t;var n=this.props,i=(n.onClick,o(n,["onClick"]));this.props.onClick&&this.props.onClick(e,a({},i))},render:function(){var e=this.props,t=e.icon,n=e.active,s=e.disabled,r=e.showHtml,l=(e.onClick,o(e,["icon","active","disabled","showHtml","onClick"])),c=r&&"source"!=t&&"separator"!=t,d="editor-icon icon-"+t+(n?" active":"")+(s||c?" disabled":"");return"fontsize"==t||"fontfamily"==t||"paragraph"==t?i.createElement("span",a({ref:"root",className:d,onClick:this.handleClick},l),i.createElement("span",{className:"icon-label"},l.name),i.createElement("span",{className:"icon-caret"})):i.createElement("span",a({ref:"root",className:d,onClick:this.handleClick},l))}});t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"react-dom":void 0}],11:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("react-dom"),i=o.createClass({
displayName:"EditorTextArea",getInitialState:function(){return{content:""}},getContent:function(){var e=a.findDOMNode(this.refs.root);return e.value},setContent:function(e){this.setState({content:e})},getName:function(){return"textarea"},handleChange:function(){var e=a.findDOMNode(this.refs.root);this.setState({content:e.value})},render:function(){return o.createElement("textarea",{ref:"root",className:"editor-textarea",value:this.state.content,onChange:this.handleChange})}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"react-dom":void 0}],12:[function(e,t,n){(function(n){"use strict";var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,i=e("./EditorIcon.react"),s=e("../../constants/EditorConstants"),r=s.EditorIconTypes,l=e("../../utils/EditorHistory"),c=a.createClass({displayName:"EditorToolbar",propTypes:{icons:a.PropTypes.array},getDefaultProps:function(){return{icons:[]}},handleIconClick:function(e,t){this.props.onIconClick&&this.props.onIconClick(e,t)},getNameByValue:function(e,t){var n=e.filter(function(e,n){return e.value==t});return n.length>0?n[0].name:""},getIcons:function(){var e=this.props.editorState;e.icons.undo={disabled:!l.canUndo()},e.icons.redo={disabled:!l.canRedo()},e.icons.fontsize&&(e.icons.fontsize.name=this.getNameByValue(this.props.fontsize,e.icons.fontsize.value)),e.icons.paragraph&&(e.icons.paragraph.name=this.getNameByValue(this.props.paragraph,e.icons.paragraph.value)),e.icons.fontfamily&&(e.icons.fontfamily.name=this.getNameByValue(this.props.fontfamily,e.icons.fontfamily.value));var t=this.props.icons,n=t.join(" ").replace(/\|/gm,"separator").split(" ");n=n.filter(function(e){return""!=e});for(var o=[],a=0;a<n.length;a++)o[a]=r[n[a]],o[a].onClick=this.handleIconClick,o[a].icon=n[a],e.icons[n[a]]&&(o[a].disabled=!!e.icons[n[a]].disabled,o[a].active=!!e.icons[n[a]].active,o[a].color=e.icons[n[a]].color,o[a].value=e.icons[n[a]].value,o[a].name=e.icons[n[a]].name),o[a].showHtml=!!e.showHtml;return o},render:function(){var e=this.getIcons();return a.createElement("div",{className:"editor-toolbar"},e.map(function(e,t){var n=e;return a.createElement(i,o({key:t},n))}),this.props.children)}});t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../../utils/EditorHistory":26,"./EditorIcon.react":10}],13:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("../base/Dropdown.react"),i=e("../../constants/EditorConstants"),s=i.ColorTypes,r=e("../../utils/EditorDOM"),l=o.createClass({displayName:"ColorDropdown",getInitialState:function(){return{handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleSelectColor:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-color");this.state.handle&&this.state.handle(e,n),this.close(),r.stopPropagation(e)},render:function(){var e=this.handleSelectColor;return this.props.hidden?o.createElement("div",null):o.createElement(a,{ref:"root",className:"color-dropdown"},o.createElement("table",null,o.createElement("tbody",null,o.createElement("tr",{className:"title-row",key:"title-row"},o.createElement("td",{colSpan:10},"主题颜色")),s.themeColors.map(function(t,n){var a=0==n;return o.createElement("tr",{key:n,className:a?"first-row":""},t.map(function(t,n){return o.createElement("td",{key:n},o.createElement("a",{className:"color-anchor","data-color":t,style:{backgroundColor:t},onClick:e}))}))}),o.createElement("tr",{className:"title-row",key:"title-row2"},o.createElement("td",{colSpan:10},"标准颜色")),o.createElement("tr",{className:"last-row",key:"last-row"},s.standardColors.map(function(t,n){return o.createElement("td",{key:n},o.createElement("a",{className:"color-anchor","data-color":t,style:{backgroundColor:t},onClick:e}))})))))}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../../utils/EditorDOM":24,"../base/Dropdown.react":6}],14:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=(e("react-dom"),e("../base/TabGroup.react")),i=e("../base/Dialog.react"),s=e("../../constants/EditorConstants"),r=s.EmotionImages,l=o.createClass({displayName:"EmotionPanel",handleClick:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-url"),o=t.getAttribute("data-title");if(this.props.onSelectImage){var a=document.createElement("img");a.src=n,a.title=o,this.props.onSelectImage(e,a)}},render:function(){var e=this.props.images,t=this.handleClick;return o.createElement("ul",{className:"emotion-images "+this.props.name},e.map(function(e,n){return o.createElement("li",{className:"emotion-image",key:n,"data-url":e.url,"data-title":e.title,onClick:t},o.createElement("img",{src:e.url,title:e.title,"data-url":e.url,"data-title":e.title}))}))}}),c=o.createClass({displayName:"EmotionDialog",getInitialState:function(){return{handle:function(){}}},open:function(e){this.setState({handle:e}),this.refs.root.open()},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e){this.setState({handle:e}),this.refs.root.toggle()},handleSelectImage:function(e,t){e=e||event,this.state.handle&&this.state.handle(e,t),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},getEmotionTabs:function(){var e=r.EmotionTabs,t=r.BaseUrl,n=r.SmileyInfor,o=[];for(var a in e){for(var i={title:e[a].name},s=[],l=n[a],c=0;c<l.length;c++){var d=(c+1).toString();d=1==d.length?"0"+d:d;var u={title:l[c],url:t+e[a].path+e[a].prefix+d+".gif?v=1.1"};s.push(u)}i.images=s,o.push(i)}return o},render:function(){for(var e=[],t=this.getEmotionTabs(),n=0;n<t.length;n++)e.push({title:t[n].title,images:t[n].images,component:o.createElement(l,{images:t[n].images,name:"common-images",onSelectImage:this.handleSelectImage})});var s=[];return this.props.hidden?o.createElement("div",null):o.createElement(i,{ref:"root",className:"emotion-dropdwon",width:700,height:508,title:"表情",buttons:s,onClose:this.close},o.createElement(a,{tabs:e}))}});t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../base/Dialog.react":5,"../base/TabGroup.react":7,"react-dom":void 0}],15:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("../base/ComboBox.react"),i=o.createClass({displayName:"FontFamilyDropdown",getInitialState:function(){return{handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleSelect:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-value");this.state.handle&&this.state.handle(e,n),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},render:function(){var e=this.handleSelect,t=this.props.fontfamily?this.props.fontfamily:[],n=this.props;return this.props.hidden?o.createElement("div",null):o.createElement(a,{ref:"root",className:"fontfamily-combobox"},o.createElement("ul",null,t.map(function(t,a){return o.createElement("li",{className:t.value==n.value?"active":"",key:a,"data-value":t.value,onClick:e},o.createElement("span",{"data-value":t.value,style:{fontFamily:t.value}},t.name))})))}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../base/ComboBox.react":4}],16:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("../base/ComboBox.react"),i=o.createClass({displayName:"FontSizeDropdown",getInitialState:function(){return{handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleSelect:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-value");this.state.handle&&this.state.handle(e,n),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},render:function(){var e=this.handleSelect,t=this.props.fontsize?this.props.fontsize:[],n=this.props;return this.props.hidden?o.createElement("div",null):o.createElement(a,{ref:"root",className:"fontsize-combobox"},o.createElement("ul",null,t.map(function(t,a){return o.createElement("li",{className:t.value==n.value?"active":"",key:a,"data-value":t.value,onClick:e},o.createElement("span",{"data-value":t.value,style:{fontSize:t.name}},t.name))})))}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../base/ComboBox.react":4}],17:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=(e("react-dom"),e("../base/TabGroup.react")),i=e("../base/Dropdown.react"),s=e("../../constants/EditorConstants"),r=s.FormulaTypes,l=o.createClass({displayName:"FormulaIcons",handleClick:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-latex"),o="mathquill-"+(new Date).valueOf();this.props.onSelectFormula&&this.props.onSelectFormula(e,n,o)},render:function(){var e=this.props.icons,t=this.handleClick;return o.createElement("ul",{className:"formulas-icons "+this.props.name},e.map(function(e,n){return o.createElement("li",{className:"latex-icon",key:n,"data-latex":e.latex,style:{backgroundPosition:e.backgroundPosition},onClick:t})}))}}),c=o.createClass({displayName:"FormulaDropdown",getInitialState:function(){return{handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleSelectFormula:function(e,t,n){e=e||event,this.state.handle&&this.state.handle(e,t,n),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},render:function(){var e=[{title:"常用公式",component:o.createElement(l,{icons:r.commonFormulas,name:"common-formulas",onSelectFormula:this.handleSelectFormula})},{title:"符号",component:o.createElement(l,{icons:r.symbolFormulas,name:"symbol-formulas",onSelectFormula:this.handleSelectFormula})},{title:"字母",component:o.createElement(l,{icons:r.arabicFormulas,name:"arabic-formulas",onSelectFormula:this.handleSelectFormula})}];return this.props.hidden?o.createElement("div",null):o.createElement(i,{ref:"root",className:"formula-dropdown"},o.createElement(a,{tabs:e}))}});t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../base/Dropdown.react":6,"../base/TabGroup.react":7,"react-dom":void 0}],18:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("react-dom"),i=e("../base/Dialog.react"),s=e("../base/TabGroup.react"),r=e("../../utils/FileUpload"),l=o.createClass({displayName:"ImageUpload",getInitialState:function(){return{images:[],dragEnter:!1}},handleUploadFile:function(e){function t(a){l.uploadFile({file:a,filename:n.props.name,url:n.props.url,type:n.props.type,qiniu:n.props.qiniu,onLoad:function(e){s.style.display="block",s.innerHTML=d+1+"/"+c.length+" Uploading..."},onSuccess:function(a){s.style.display="block",s.innerHTML="Load Success",a&&"success"==a.status&&(o.push({src:a.data[i||"image_src"]}),n.setState({images:o}),n.props.onChange&&n.props.onChange(0,o)),setTimeout(function(){d+1<c.length?(d+=1,t(c[d])):(s.style.display="none",d=0,e.dropEffect||(console.log("done"),e.value=""))},200)},onError:function(e){s.style.display="block",s.innerHTML="Load Error",setTimeout(function(){s.style.display="none"},200)}})}var n=this,o=this.state.images,i=this.props.request,s=a.findDOMNode(this.refs.mask),l=this.props.customUploader?this.props.customUploader:r,c=e.files,d=0;t(c[d])},handleChange:function(e){e=e||event;var t=e.target||e.srcElement;t.files.length>0&&this.handleUploadFile(t)},getImages:function(){return this.state.images},clearImages:function(){this.setState({images:[]})},handleRemoveImage:function(e){e=e||event;var t=e.target||e.srcElement,n=parseInt(t.getAttribute("data-index")),o=this.state.images;o.splice(n,1),this.setState({images:o}),this.props.onChange&&this.props.onChange(0,o)},handleDrop:function(e){e.preventDefault();var t=e.dataTransfer.files;t.length>0&&this.handleUploadFile(e.dataTransfer),this.setState({dragEnter:!1}),console.log(e.type)},handleDragOver:function(e){e.preventDefault(),console.log(e.type)},handleDragEnter:function(e){this.setState({dragEnter:!0}),console.log(e.type)},handleDragLeave:function(e){this.setState({dragEnter:!1}),console.log(e.type)},render:function(){var e=this.state.images,t=this.state.dragEnter,n=this.handleRemoveImage,a=this.props.action?this.props.action:"/upload",i={display:"block"},s={display:"none"},r=e.length>0;return o.createElement("div",{className:"tab-panel"},o.createElement("div",{className:"image-content"+(t?" drag-enter":""),onDrop:this.handleDrop,onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDragEnd:this.handleDragLeave,onDragStart:this.handleDragEnter},e.map(function(e,t){return o.createElement("div",{className:"image-item"},o.createElement("div",{className:"image-close","data-index":t,onClick:n}),o.createElement("img",{src:e.src,className:"image-pic",height:"75",width:"120"}))}),o.createElement("div",{className:"image-upload2",style:r?i:s},o.createElement("span",{className:"image-icon"}),o.createElement("form",{className:"image-form",method:"post",encType:"multipart/form-data",target:"up",action:a},o.createElement("input",{onChange:this.handleChange,multiple:"multiple",style:{filter:"alpha(opacity=0)"},className:"image-file",type:"file",name:"file",accept:"image/gif,image/jpeg,image/png,image/jpg,image/bmp"})))),o.createElement("div",{className:"image-dragTip",style:r?s:i},"支持图片拖拽上传"),o.createElement("div",{className:"image-upload1",style:r?s:i},o.createElement("span",{className:"image-icon"}),o.createElement("form",{className:"image-form",method:"post",encType:"multipart/form-data",target:"up",action:a},o.createElement("input",{onChange:this.handleChange,multiple:"multiple",style:{filter:"alpha(opacity=0)"},className:"image-file",type:"file",name:"file",accept:"image/gif,image/jpeg,image/png,image/jpg,image/bmp"}))),o.createElement("div",{className:"image-mask",ref:"mask"},"Loading...."))}}),c=o.createClass({displayName:"ImageSearch",getInitialState:function(){return{images:[]}},getImages:function(){return this.state.images},clearImages:function(){this.setState({images:[]})},handleClick:function(e){var t=a.findDOMNode(this.refs.text),n=t.value,o=this.state.images;n&&n.length>0&&(o.push({src:n}),this.setState({images:o}),this.props.onChange&&this.props.onChange(1,o),t.value="")},handleRemoveImage:function(e){e=e||event;var t=e.target||e.srcElement,n=parseInt(t.getAttribute("data-index")),o=this.state.images;o.splice(n,1),this.setState({images:o})},render:function(){var e=this.state.images,t=this.handleRemoveImage;return o.createElement("div",{className:"tab-panel"},o.createElement("table",{className:"search-bar"},o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",null,o.createElement("input",{className:"image-searchTxt",type:"text",ref:"text"})),o.createElement("td",null,o.createElement("div",{className:"image-searchAdd",onClick:this.handleClick},"添加"))))),o.createElement("div",{className:"image-content"},e.map(function(e,n){return o.createElement("div",{key:n,className:"image-item"},o.createElement("div",{className:"image-close","data-index":n,onClick:t}),o.createElement("img",{src:e.src,className:"image-pic",height:"75",width:"120"}))})))}}),d=o.createClass({displayName:"ImageDialog",getInitialState:function(){return{images:[[],[]],handle:function(){}}},propTypes:{uploader:o.PropTypes.object,customUploader:o.PropTypes.object},getDefaultProps:function(){return{uploader:{type:"default",name:"file",url:"/upload",request:"image_src",qiniu:{app:{bucket:"qtestbucket",ak:"iN7NgwM31j4-BZacMjPrOQBs34UG1maYCAQmhdCV",sk:"6QTOr2Jg1gcZEWDQXKOGZh5PziC2MCV5KsntT70j"},key:null,upload_token:null}}}},open:function(e){this.setState({handle:e}),this.refs.modal.open()},close:function(){this.refs.modal&&(this.refs.modal.close(),this.state.handle&&this.state.handle(),this.refs.image.clearImages())},toggle:function(e){this.setState({handle:e}),this.refs.modal.toggle()},handleOkClick:function(e){var t=this.refs.tab.getTabIndex(),n=this.state.images[t],o="";if(n.length>0&&this.state.handle){for(var a=0;a<n.length;a++){var i=n[a].src,s="<img src='"+i+"' />";o+=s}this.state.handle(e,o)}this.close()},handleChange:function(e,t){var n=this.state.images;n[e]=t,this.setState({images:n})},render:function(){var e=this.props.uploader,t=[{name:"btn-ok",content:"确定",onClick:this.handleOkClick},{name:"btn-cancel",content:"取消",onClick:this.close}],n=[{title:"本地上传",component:o.createElement(l,{ref:"image",onChange:this.handleChange,request:e.request,type:e.type,name:e.name,url:e.url,qiniu:e.qiniu})},{title:"网络图片",component:o.createElement(c,{ref:"image",onChange:this.handleChange})}];return this.props.hidden?o.createElement("div",null):o.createElement(i,{ref:"modal",className:"image-dialog",width:700,height:508,title:"图片",buttons:t,onClose:this.close},o.createElement(s,{tabs:n,ref:"tab"}))}});t.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/FileUpload":30,"../base/Dialog.react":5,"../base/TabGroup.react":7,"react-dom":void 0}],19:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("../base/ComboBox.react"),i=o.createClass({displayName:"ParagraphDropdown",getInitialState:function(){return{handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleSelect:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-value");this.state.handle&&this.state.handle(e,n),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},render:function(){var e=this.handleSelect,t=this.props.paragraph?this.props.paragraph:[],n=this.props;return this.props.hidden?o.createElement("div",null):o.createElement(a,{ref:"root",className:"paragraph-combobox"},o.createElement("ul",null,t.map(function(t,a){return o.createElement("li",{className:t.value==n.value?"active":"",key:a,"data-value":t.value,onClick:e},o.createElement(t.value,{"data-value":t.value},t.name))})))}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../base/ComboBox.react":4}],20:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=(e("react-dom"),e("../base/TabGroup.react")),i=e("../base/Dialog.react"),s=e("../../constants/EditorConstants"),r=s.SpecialChars,l=o.createClass({displayName:"SCChars",handleClick:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getAttribute("data-char");"char-"+(new Date).valueOf();this.props.onSelectChar&&this.props.onSelectChar(e,n)},render:function(){var e=this.props.chars,t=this.handleClick;return o.createElement("ul",{className:"special-chars "+this.props.name},e.map(function(e,n){return o.createElement("li",{className:"special-char",key:n,"data-char":e,onClick:t},e)}))}}),c=o.createClass({displayName:"SpecialCharsDialog",getInitialState:function(){return{handle:function(){}}},open:function(e){this.setState({handle:e}),this.refs.root.open()},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e){this.setState({handle:e}),this.refs.root.toggle()},handleSelectChar:function(e,t){e=e||event,this.state.handle&&this.state.handle(e,t),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.close()},render:function(){for(var e=[],t=0;t<r.length;t++)e.push({title:r[t].title,chars:r[t].chars,component:o.createElement(l,{chars:r[t].chars,name:"common-chars",onSelectChar:this.handleSelectChar})});var n=[];return this.props.hidden?o.createElement("div",null):o.createElement(i,{ref:"root",className:"special-chars-dialog",width:700,height:508,title:"特殊字符",buttons:n,onClose:this.close},o.createElement(a,{tabs:e}))}});t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../constants/EditorConstants":22,"../base/Dialog.react":5,"../base/TabGroup.react":7,"react-dom":void 0}],21:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("../base/Dropdown.react"),i=o.createClass({displayName:"TablePickerDropdown",getInitialState:function(){return{row:0,column:0,handle:function(){}}},open:function(e,t){this.setState({handle:t}),this.refs.root.open(e)},close:function(){this.refs.root&&this.refs.root.close()},toggle:function(e,t){this.setState({handle:t}),this.refs.root.toggle(e)},handleMouseEvent:function(e){e=e||event;var t=e.target||e.srcElement,n=t.getBoundingClientRect(),o=Math.ceil((e.clientX-n.left)/22),a=Math.ceil((e.clientY-n.top)/22);0>o&&(o=0),0>a&&(a=0),o>10&&(o=10),a>10&&(a=10),this.setState({row:o,column:a})},handleMouseOut:function(e){this.setState({row:0,column:0})},handleClick:function(e){var t=document.createElement("table");t.className="editor-table";for(var n=t.createTBody(),o=0;o<this.state.row;o++)for(var a=n.insertRow(),i=0;i<this.state.column;i++){var s=a.insertCell();s.width=200}this.state.handle(e,t),this.refs.root.close()},render:function(){var e=this.state.row,t=this.state.column;return this.props.hidden?o.createElement("div",null):o.createElement(a,{ref:"root",className:"tablepicker-dropdown"},o.createElement("div",{className:"infoarea"}," ",o.createElement("span",null,t+"列 x "+e+"行")),o.createElement("div",{className:"pickarea",onMouseOver:this.handleMouseEvent,onMouseMove:this.handleMouseEvent,onMouseOut:this.handleMouseOut,onClick:this.handleClick},o.createElement("div",{className:"overlay",style:{width:22*e,height:22*t}})))}});t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../base/Dropdown.react":6}],22:[function(e,t,n){"use strict";var o={source:{title:"源代码",disabled:!1},separator:{disabled:!1},undo:{title:"撤销",disabled:!1},redo:{title:"重做",disabled:!1},bold:{title:"加粗",disabled:!1},italic:{title:"斜线",disabled:!1},underline:{title:"下划线",disabled:!1},strikethrough:{title:"删除线",disabled:!1},superscript:{title:"上标",disabled:!1},subscript:{title:"下标",disabled:!1},forecolor:{title:"字体颜色",disabled:!1},backcolor:{title:"背景色",disabled:!1},removeformat:{title:"清除格式",disabled:!1},insertunorderedlist:{title:"无序列表",disabled:!1},insertorderedlist:{title:"有序列表",disabled:!1},selectall:{title:"全选",disabled:!1},cleardoc:{title:"清空文档",disabled:!1},paragraph:{title:"段落格式",disabled:!1},fontfamily:{title:"字体",disabled:!1},fontsize:{title:"字号",disabled:!1},justifyleft:{title:"居左对齐",disabled:!1},justifycenter:{title:"居中对齐",disabled:!1},justifyright:{title:"居右对齐",disabled:!1},link:{title:"超链接",disabled:!1},unlink:{title:"取消链接",disabled:!1},emotion:{title:"表情",disabled:!1},image:{title:"图片",disabled:!1},video:{title:"视频",disabled:!1},map:{title:"百度地图",disabled:!1},horizontal:{title:"分隔线",disabled:!1},print:{title:"打印",disabled:!1},preview:{title:"预览",disabled:!1},drafts:{title:"草稿箱",disabled:!1},formula:{title:"数学公式",disabled:!1},inserttable:{title:"插入表格",disabled:!1},touppercase:{title:"转换大写",disabled:!1},tolowercase:{title:"转换小写",disabled:!1},indent:{title:"增加缩进",disabled:!1},outdent:{title:"减少缩进",disabled:!1},spechars:{title:"特殊符号",disabled:!1},fontborder:{title:"字体边框",disabled:!1},date:{title:"插入日期",disabled:!1},time:{title:"插入时间",disabled:!1},emphasis:{title:"着重号",disabled:!1}},a={themeColors:[["#fff","#000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"],["#f2f2f2","7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada"],["#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5"],["#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#92cddc","#fac08f"],["#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#31859b","#e36c09"],["#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#205867","#974806"]],standardColors:["#c00000","#ff0000","#ffc000","#ffff00","#92d050","#00b050","#00b0f0","#0070c0","#002060","#7030a0"]},i={commonFormulas:[{backgroundPosition:"-0px -0px",latex:"\\frac{ }{ }"},{backgroundPosition:"-30px -0px",latex:"^{ }/_{ }"},{backgroundPosition:"-60px -0px",latex:"x^{ }"},{backgroundPosition:"-90px -0px",latex:"x_{ }"},{backgroundPosition:"-120px -0px",latex:"x^{ }_{ }"},{backgroundPosition:"-150px -0px",latex:"\\bar{ }"},{backgroundPosition:"-180px -0px",latex:"\\sqrt{ }"},{backgroundPosition:"-210px -0px",latex:"\\nthroot{ }{ }"},{backgroundPosition:"-0px -30px",latex:"\\sum^{ }_{n=}"},{backgroundPosition:"-60px -30px",latex:"\\log_{ }"},{backgroundPosition:"-90px -30px",latex:"\\ln"},{backgroundPosition:"-120px -30px",latex:"\\int_{ }^{ }"},{backgroundPosition:"-150px -30px",latex:"\\oint_{ }^{ }"}],symbolFormulas:[{backgroundPosition:"-0px -60px",latex:"+"},{backgroundPosition:"-30px -60px",latex:"-"},{backgroundPosition:"-60px -60px",latex:"\\pm"},{backgroundPosition:"-90px -60px",latex:"\\times"},{backgroundPosition:"-120px -60px",latex:"\\ast"},{backgroundPosition:"-150px -60px",latex:"\\div"},{backgroundPosition:"-180px -60px",latex:"/"},{backgroundPosition:"-210px -60px",latex:"\\bigtriangleup"},{backgroundPosition:"-0px -90px",latex:"="},{backgroundPosition:"-30px -90px",latex:"\\ne"},{backgroundPosition:"-60px -90px",latex:"\\approx"},{backgroundPosition:"-90px -90px",latex:">"},{backgroundPosition:"-120px -90px",latex:"<"},{backgroundPosition:"-150px -90px",latex:"\\ge"},{backgroundPosition:"-180px -90px",latex:"\\le"},{backgroundPosition:"-210px -90px",latex:"\\infty"},{backgroundPosition:"-0px -120px",latex:"\\cap"},{backgroundPosition:"-30px -120px",latex:"\\cup"},{backgroundPosition:"-60px -120px",latex:"\\because"},{backgroundPosition:"-90px -120px",latex:"\\therefore"},{backgroundPosition:"-120px -120px",latex:"\\subset"},{backgroundPosition:"-150px -120px",latex:"\\supset"},{backgroundPosition:"-180px -120px",latex:"\\subseteq"},{backgroundPosition:"-210px -120px",latex:"\\supseteq"},{backgroundPosition:"-0px -150px",latex:"\\nsubseteq"},{backgroundPosition:"-30px -150px",latex:"\\nsupseteq"},{backgroundPosition:"-60px -150px",latex:"\\in"},{backgroundPosition:"-90px -150px",latex:"\\ni"},{backgroundPosition:"-120px -150px",latex:"\\notin"},{backgroundPosition:"-150px -150px",latex:"\\mapsto"},{backgroundPosition:"-180px -150px",latex:"\\leftarrow"},{backgroundPosition:"-210px -150px",latex:"\\rightarrow"},{backgroundPosition:"-0px -180px",latex:"\\Leftarrow"},{backgroundPosition:"-30px -180px",latex:"\\Rightarrow"},{backgroundPosition:"-60px -180px",latex:"\\leftrightarrow"},{backgroundPosition:"-90px -180px",latex:"\\Leftrightarrow"}],arabicFormulas:[{backgroundPosition:"-0px -210px",latex:"\\alpha"},{backgroundPosition:"-30px -210px",latex:"\\beta"},{backgroundPosition:"-60px -210px",latex:"\\gamma"},{backgroundPosition:"-90px -210px",latex:"\\delta"},{backgroundPosition:"-120px -210px",latex:"\\varepsilon"},{backgroundPosition:"-150px -210px",latex:"\\varphi"},{backgroundPosition:"-180px -210px",latex:"\\lambda"},{backgroundPosition:"-210px -210px",latex:"\\mu"},{backgroundPosition:"-0px -240px",latex:"\\rho"},{backgroundPosition:"-30px -240px",latex:"\\sigma"},{backgroundPosition:"-60px -240px",latex:"\\omega"},{backgroundPosition:"-90px -240px",latex:"\\Gamma"},{backgroundPosition:"-120px -240px",latex:"\\Delta"},{backgroundPosition:"-150px -240px",latex:"\\Theta"},{backgroundPosition:"-180px -240px",latex:"\\Lambda"},{backgroundPosition:"-210px -240px",latex:"\\Xi"},{backgroundPosition:"-0px -270px",latex:"\\Pi"},{backgroundPosition:"-30px -270px",latex:"\\Sigma"},{backgroundPosition:"-60px -270px",latex:"\\Upsilon"},{backgroundPosition:"-90px -270px",latex:"\\Phi"},{backgroundPosition:"-120px -270px",latex:"\\Psi"},{backgroundPosition:"-150px -270px",latex:"\\Omega"}]},s=function(e){return e.split(",")},r=[{name:"tsfh",title:"特殊字符",chars:s("、,。,·,ˉ,ˇ,¨,〃,々,—,～,‖,…,‘,’,“,”,〔,〕,〈,〉,《,》,「,」,『,』,〖,〗,【,】,±,×,÷,∶,∧,∨,∑,∏,∪,∩,∈,∷,√,⊥,∥,∠,⌒,⊙,∫,∮,≡,≌,≈,∽,∝,≠,≮,≯,≤,≥,∞,∵,∴,♂,♀,°,′,″,℃,＄,¤,￠,￡,‰,§,№,☆,★,○,●,◎,◇,◆,□,■,△,▲,※,→,←,↑,↓,〓,〡,〢,〣,〤,〥,〦,〧,〨,〩,㊣,㎎,㎏,㎜,㎝,㎞,㎡,㏄,㏎,㏑,㏒,㏕,︰,￢,￤,℡,ˊ,ˋ,˙,–,―,‥,‵,℅,℉,↖,↗,↘,↙,∕,∟,∣,≒,≦,≧,⊿,═,║,╒,╓,╔,╕,╖,╗,╘,╙,╚,╛,╜,╝,╞,╟,╠,╡,╢,╣,╤,╥,╦,╧,╨,╩,╪,╫,╬,╭,╮,╯,╰,╱,╲,╳,▁,▂,▃,▄,▅,▆,▇,�,█,▉,▊,▋,▌,▍,▎,▏,▓,▔,▕,▼,▽,◢,◣,◤,◥,☉,⊕,〒,〝,〞")},{name:"lmsz",title:"罗马字符",chars:s("ⅰ,ⅱ,ⅲ,ⅳ,ⅴ,ⅵ,ⅶ,ⅷ,ⅸ,ⅹ,Ⅰ,Ⅱ,Ⅲ,Ⅳ,Ⅴ,Ⅵ,Ⅶ,Ⅷ,Ⅸ,Ⅹ,Ⅺ,Ⅻ")},{name:"szfh",title:"数学字符",chars:s("⒈,⒉,⒊,⒋,⒌,⒍,⒎,⒏,⒐,⒑,⒒,⒓,⒔,⒕,⒖,⒗,⒘,⒙,⒚,⒛,⑴,⑵,⑶,⑷,⑸,⑹,⑺,⑻,⑼,⑽,⑾,⑿,⒀,⒁,⒂,⒃,⒄,⒅,⒆,⒇,①,②,③,④,⑤,⑥,⑦,⑧,⑨,⑩,㈠,㈡,㈢,㈣,㈤,㈥,㈦,㈧,㈨,㈩")},{name:"rwfh",title:"日文字符",chars:s("ぁ,あ,ぃ,い,ぅ,う,ぇ,え,ぉ,お,か,が,き,ぎ,く,ぐ,け,げ,こ,ご,さ,ざ,し,じ,す,ず,せ,ぜ,そ,ぞ,た,だ,ち,ぢ,っ,つ,づ,て,で,と,ど,な,に,ぬ,ね,の,は,ば,ぱ,ひ,び,ぴ,ふ,ぶ,ぷ,へ,べ,ぺ,ほ,ぼ,ぽ,ま,み,む,め,も,ゃ,や,ゅ,ゆ,ょ,よ,ら,り,る,れ,ろ,ゎ,わ,ゐ,ゑ,を,ん,ァ,ア,ィ,イ,ゥ,ウ,ェ,エ,ォ,オ,カ,ガ,キ,ギ,ク,グ,ケ,ゲ,コ,ゴ,サ,ザ,シ,ジ,ス,ズ,セ,ゼ,ソ,ゾ,タ,ダ,チ,ヂ,ッ,ツ,ヅ,テ,デ,ト,ド,ナ,ニ,ヌ,ネ,ノ,ハ,バ,パ,ヒ,ビ,ピ,フ,ブ,プ,ヘ,ベ,ペ,ホ,ボ,ポ,マ,ミ,ム,メ,モ,ャ,ヤ,ュ,ユ,ョ,ヨ,ラ,リ,ル,レ,ロ,ヮ,ワ,ヰ,ヱ,ヲ,ン,ヴ,ヵ,ヶ")},{name:"xlzm",title:"希腊字符",chars:s("Α,Β,Γ,Δ,Ε,Ζ,Η,Θ,Ι,Κ,Λ,Μ,Ν,Ξ,Ο,Π,Ρ,Σ,Τ,Υ,Φ,Χ,Ψ,Ω,α,β,γ,δ,ε,ζ,η,θ,ι,κ,λ,μ,ν,ξ,ο,π,ρ,σ,τ,υ,φ,χ,ψ,ω")},{name:"ewzm",title:"俄文字符",chars:s("А,Б,В,Г,Д,Е,Ё,Ж,З,И,Й,К,Л,М,Н,О,П,Р,С,Т,У,Ф,Х,Ц,Ч,Ш,Щ,Ъ,Ы,Ь,Э,Ю,Я,а,б,в,г,д,е,ё,ж,з,и,й,к,л,м,н,о,п,р,с,т,у,ф,х,ц,ч,ш,щ,ъ,ы,ь,э,ю,я")},{name:"pyzm",title:"拼音字母",chars:s("ā,á,ǎ,à,ē,é,ě,è,ī,í,ǐ,ì,ō,ó,ǒ,ò,ū,ú,ǔ,ù,ǖ,ǘ,ǚ,ǜ,ü")},{name:"yyyb",title:"英语音标",chars:s("i:,i,e,æ,ʌ,ə:,ə,u:,u,ɔ:,ɔ,a:,ei,ai,ɔi,əu,au,iə,εə,uə,p,t,k,b,d,g,f,s,ʃ,θ,h,v,z,ʒ,ð,tʃ,tr,ts,dʒ,dr,dz,m,n,ŋ,l,r,w,j,")},{name:"zyzf",title:"其它",chars:s("ㄅ,ㄆ,ㄇ,ㄈ,ㄉ,ㄊ,ㄋ,ㄌ,ㄍ,ㄎ,ㄏ,ㄐ,ㄑ,ㄒ,ㄓ,ㄔ,ㄕ,ㄖ,ㄗ,ㄘ,ㄙ,ㄚ,ㄛ,ㄜ,ㄝ,ㄞ,ㄟ,ㄠ,ㄡ,ㄢ,ㄣ,ㄤ,ㄥ,ㄦ,ㄧ,ㄨ")}],l={DemoUrl:"http://img.baidu.com/hi/tsj/t_0001.gif",BaseUrl:"http://img.baidu.com/hi/",SmileyInfor:{tab0:["Kiss","Love","Yeah","啊！","背扭","顶","抖胸","88","汗","瞌睡","鲁拉","拍砖","揉脸","生日快乐","大笑","瀑布汗~","惊讶","臭美","傻笑","抛媚眼","发怒","打酱油","俯卧撑","气愤","?","吻","怒","胜利","HI","KISS","不说","不要","扯花","大心","顶","大惊","飞吻","鬼脸","害羞","口水","狂哭","来","发财了","吃西瓜","套牢","害羞","庆祝","我来了","敲打","晕了","胜利","臭美","被打了","贪吃","迎接","酷","微笑","亲吻","调皮","惊恐","耍酷","发火","害羞","汗水","大哭","","加油","困","你NB","晕倒","开心","偷笑","大哭","滴汗","叹气","超赞","??","飞吻","天使","撒花","生气","被砸","吓傻","随意吐"],tab1:["Kiss","Love","Yeah","啊！","背扭","顶","抖胸","88","汗","瞌睡","鲁拉","拍砖","揉脸","生日快乐","摊手","睡觉","瘫坐","无聊","星星闪","旋转","也不行","郁闷","正Music","抓墙","撞墙至死","歪头","戳眼","飘过","互相拍砖","砍死你","扔桌子","少林寺","什么？","转头","我爱牛奶","我踢","摇晃","晕厥","在笼子里","震荡"],tab2:["大笑","瀑布汗~","惊讶","臭美","傻笑","抛媚眼","发怒","我错了","money","气愤","挑逗","吻","怒","胜利","委屈","受伤","说啥呢？","闭嘴","不","逗你玩儿","飞吻","眩晕","魔法","我来了","睡了","我打","闭嘴","打","打晕了","刷牙","爆揍","炸弹","倒立","刮胡子","邪恶的笑","不要不要","爱恋中","放大仔细看","偷窥","超高兴","晕","松口气","我跑","享受","修养","哭","汗","啊~","热烈欢迎","打酱油","俯卧撑","?"],
tab3:["HI","KISS","不说","不要","扯花","大心","顶","大惊","飞吻","鬼脸","害羞","口水","狂哭","来","泪眼","流泪","生气","吐舌","喜欢","旋转","再见","抓狂","汗","鄙视","拜","吐血","嘘","打人","蹦跳","变脸","扯肉","吃To","吃花","吹泡泡糖","大变身","飞天舞","回眸","可怜","猛抽","泡泡","苹果","亲","","骚舞","烧香","睡","套娃娃","捅捅","舞倒","西红柿","爱慕","摇","摇摆","杂耍","招财","被殴","被球闷","大惊","理想","欧打","呕吐","碎","吐痰"],tab4:["发财了","吃西瓜","套牢","害羞","庆祝","我来了","敲打","晕了","胜利","臭美","被打了","贪吃","迎接","酷","顶","幸运","爱心","躲","送花","选择"],tab5:["微笑","亲吻","调皮","惊讶","耍酷","发火","害羞","汗水","大哭","得意","鄙视","困","夸奖","晕倒","疑问","媒婆","狂吐","青蛙","发愁","亲吻","","爱心","心碎","玫瑰","礼物","哭","奸笑","可爱","得意","呲牙","暴汗","楚楚可怜","困","哭","生气","惊讶","口水","彩虹","夜空","太阳","钱钱","灯泡","咖啡","蛋糕","音乐","爱","胜利","赞","鄙视","OK"],tab6:["男兜","女兜","开心","乖乖","偷笑","大笑","抽泣","大哭","无奈","滴汗","叹气","狂晕","委屈","超赞","??","疑问","飞吻","天使","撒花","生气","被砸","口水","泪奔","吓傻","吐舌头","点头","随意吐","旋转","困困","鄙视","狂顶","篮球","再见","欢迎光临","恭喜发财","稍等","我在线","恕不议价","库房有货","货在路上"]},EmotionTabs:{tab0:{name:"精选",prefix:"j_00",path:"jx2/"},tab1:{name:"兔斯基",prefix:"t_00",path:"tsj/"},tab2:{name:"绿豆蛙",prefix:"w_00",path:"ldw/"},tab3:{name:"BOBO",prefix:"B_00",path:"bobo/"},tab4:{name:"baby猫",prefix:"C_00",path:"babycat/"},tab5:{name:"泡泡",prefix:"i_f",path:"face/"},tab6:{name:"有啊",prefix:"y_00",path:"youa/"}}};t.exports={EditorIconTypes:o,ColorTypes:a,FormulaTypes:i,SpecialChars:r,EmotionImages:l}},{}],23:[function(e,t,n){(function(n){"use strict";function o(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,s=(e("react-dom"),e("./components/core/EditorCore.react")),r=e("./utils/EditorEventEmitter");Date.prototype.Format||(Date.prototype.Format=function(e){var t,n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(t in n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e});var l=i.createClass({displayName:"Editor",getInitialState:function(){return{loaded:!1,reload:!0}},propTypes:{plugins:i.PropTypes.object,fontFamily:i.PropTypes.array,fontSize:i.PropTypes.array,paragraph:i.PropTypes.array},getDefaultProps:function(){return{plugins:{image:{uploader:{type:"default",name:"file",url:"/upload",qiniu:{app:{Bucket:"qtestbucket",AK:"iN7NgwM31j4-BZacMjPrOQBs34UG1maYCAQmhdCV",SK:"6QTOr2Jg1gcZEWDQXKOGZh5PziC2MCV5KsntT70j"},key:null,upload_token:null,domain:"http://o9sa2vijj.bkt.clouddn.com",genKey:function(e){return e.file.type+"-"+e.file.size+"-"+e.file.lastModifiedDate.valueOf()+"-"+(new Date).valueOf()+"-"+e.file.name}}}}},fontFamily:[{name:"宋体",value:"宋体, SimSun",defualt:!0},{name:"隶书",value:"隶书, SimLi"},{name:"楷体",value:"楷体, SimKai"},{name:"微软雅黑",value:"微软雅黑, Microsoft YaHei"},{name:"黑体",value:"黑体, SimHei"},{name:"arial",value:"arial, helvetica, sans-serif"},{name:"arial black",value:"arial black, avant garde"},{name:"omic sans ms",value:"omic sans ms"},{name:"impact",value:"impact, chicago"},{name:"times new roman",value:"times new roman"},{name:"andale mono",value:"andale mono"}],fontSize:[{name:"10px",value:"1"},{name:"12px",value:"2"},{name:"16px",value:"3",defualt:!0},{name:"18px",value:"4"},{name:"24px",value:"5"},{name:"32px",value:"6"},{name:"38px",value:"7"}],paragraph:[{name:"段落",value:"p",defualt:!0},{name:"标题1",value:"h1"},{name:"标题2",value:"h2"},{name:"标题3",value:"h3"},{name:"标题4",value:"h4"},{name:"标题5",value:"h5"},{name:"标题6",value:"h6"}],icons:["source | undo redo | bold italic underline strikethrough fontborder emphasis | ","paragraph fontfamily fontsize | superscript subscript | ","forecolor backcolor | removeformat | insertorderedlist insertunorderedlist | selectall | ","cleardoc  | indent outdent | justifyleft justifycenter justifyright | touppercase tolowercase | ","horizontal date time  | image emotion formula spechars | inserttable"]}},componentDidMount:function(){this.index=r.editorSum,r.addStartListener("start-"+this.index,this.handleChange)},componentWillUnmount:function(){var e=this.index;r.removeStartListener("start-"+e,this.handleChange)},componentDidUpdate:function(){this.state.loaded&&this.state.reload&&this.refs.editor.setContent(this.props.value||this.props.defaultValue)},handleChange:function(){this.setState({loaded:!0})},handleMountSuccess:function(){r.mountEditorSuccess()},componentWillReceiveProps:function(e){var t=this.props.value||this.props.defaultValue,n=this.getContent(),o=e.value||e.defaultValue;t!=n||o!=t&&o!=n?this.setState({reload:!0}):this.setState({reload:!1})},shouldComponentUpdate:function(e,t){return t.reload||this.state.loaded!=t.loaded},getContent:function(){return this.refs.editor?this.refs.editor.getContent():""},setContent:function(e){return this.refs.editor?this.refs.editor.setContent(e):""},focusEditor:function(){return this.refs.editor?this.refs.editor.focusEditor():""},findDOMNode:function(e){return this.refs.editor?this.refs.editor.findDOMNode(e):""},render:function(){var e=(this.state.loaded,this.props),t=(e.value,e.defaultValue,o(e,["value","defaultValue"]));return this.state.loaded?i.createElement(s,a({ref:"editor"},t,{onEditorMount:this.handleMountSuccess})):i.createElement("div",{id:t.id,className:"editor-contenteditable-div",style:{minHeight:"30px",border:"1px solid #ddd"}},"正在加载...")}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/core/EditorCore.react":9,"./utils/EditorEventEmitter":25,"react-dom":void 0}],24:[function(e,t,n){"use strict";var o={stopPropagation:function(e){e=e||event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},isTextNode:function(e){return e?3==e.nodeType||"#text"==e.nodeName:!1},isSpanNode:function(e){return e?1==e.nodeType&&"SPAN"==e.nodeName:!1},isNullOfTextNode:function(e){return this.isTextNode(e)?""==e.nodeValue:!1},getOffsetRootParentPosition:function(e,t){var n={x:0,y:0,w:0,h:0};n.w=e.offsetWidth,n.h=e.offsetHeight,n.x=e.offsetLeft,n.y=e.offsetTop;for(var o=e.offsetParent;o&&o!=t&&o.offsetParent!=t.offsetParent;)n.x+=o.offsetLeft,n.y+=o.offsetTop,o=o.offsetParent;return o==t&&(n.x=n.x-parseFloat(o.style.paddingLeft||0),n.y=n.y-parseFloat(o.style.paddingTop||0)),n},createTextNode:function(e){return document.createTextNode(e)},createNodeByTag:function(e,t){var n=document.createElement(e);return n.innerHTML=t,n},createHR:function(){var e=document.createElement("hr");return e},createBR:function(){var e=document.createElement("br");return e}};t.exports=o},{}],25:[function(e,t,n){"use strict";var o=e("events").EventEmitter,a=e("object-assign"),i=a({},o.prototype,{editorSum:0,editorStack:[],isStart:!1,startTime:null,addStartListener:function(e,t){0==this.editorStack.length&&0==this.isStart&&(this.startTime=this.startTime||new Date),this.editorSum=this.editorSum+1,this.editorStack.push(e),this.on(e,t),this.emitNextListener()},removeStartListener:function(e,t){this.removeListener(e,t);var n=this.editorStack.indexOf(e);this.editorStack.splice(n,1)},mountEditorSuccess:function(){this.isStart=!1,this.emitNextListener()},emitNextListener:function(){if(0==this.editorStack.length)this.isStart=!1;else if(0==this.isStart){this.isStart=!0;var e=this.editorStack.shift();this.emit(e);var t=new Date;this.startTime=this.startTime||new Date,console.log("emitNextListener:"+e+" "+(t.valueOf()-this.startTime.valueOf())+"ms")}}});i.setMaxListeners(1e3),t.exports=i},{events:3,"object-assign":2}],26:[function(e,t,n){"use strict";var o=e("./EditorSelection"),a={curCommand:null,commandStack:[],commandIndex:-1,canUndo:function(){return this.commandStack.length>0&&-1!=this.commandIndex},canRedo:function(){return this.commandStack.length>0&&this.commandIndex!=this.commandStack.length-1},undo:function(){return this.canUndo()&&(this.commandIndex=this.commandIndex-1,this.curCommand=this.commandStack[this.commandIndex],document.execCommand("undo")),this.canUndo()},redo:function(){return this.canRedo()&&(this.commandIndex=this.commandIndex+1,this.curCommand=this.commandStack[this.commandIndex],document.execCommand("redo")),this.canRedo()},execCommand:function(e,t,n){switch(e){case"inserthtml":var a=o.getSelection();a.pasteHTML?a.pasteHTML(n):document.execCommand(e,t,n);break;default:document.execCommand(e,t,n)}"selectall"!=e&&(this.commandIndex=this.commandIndex+1,this.curCommand={command:e,flag:t,args:n},this.commandStack.splice(this.commandIndex,this.commandStack.length-this.commandIndex),this.commandStack[this.commandIndex]={command:e,flag:t,args:n})},getCurCommand:function(){return this.curCommand},getCommandStack:function(){return this.commandStack},getCommandIndex:function(){return this.commandIndex},clear:function(){this.curCommand=null,this.commandStack=[],this.commandIndex=-1}};t.exports=a},{"./EditorSelection":28}],27:[function(e,t,n){(function(n){"use strict";var o="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,a=e("react-dom"),i=e("./EditorDOM"),s=12,r=12,l=o.createClass({displayName:"EditorResize",getInitialState:function(){return{target:null,position:{x:0,y:0},width:0,height:0,startPosition:{x:0,y:0},curPosition:{x:0,y:0}}},setTarget:function(e){var t=a.findDOMNode(this.refs.root),n=i.getOffsetRootParentPosition(e,t.parentElement),o=n.w,s=n.h,r={x:n.x,y:n.y};this.setState({target:e,width:o,height:s,show:!0,position:r})},getTarget:function(){return this.state.target},clearTarget:function(){this.setState({target:null,show:!1})},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},clearSelect:function(e){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()},getMousePosition:function(e){e=e||window.event;var t=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,o=parseFloat(e.pageX||e.clientX+t),a=parseFloat(e.pageY||e.clientY+n);return{x:o,y:a}},handleMouseDown:function(e){e=e||event;var t=e.target||e.srcElement,n=t.className,o=this.getMousePosition(e);this.clearSelect(),-1!=n.indexOf("nw-resize")&&this.setState({direction:"nw-resize",startPosition:o}),-1!=n.indexOf("ne-resize")&&this.setState({direction:"ne-resize",startPosition:o}),-1!=n.indexOf("sw-resize")&&this.setState({direction:"sw-resize",startPosition:o}),-1!=n.indexOf("se-resize")&&this.setState({direction:"se-resize",startPosition:o}),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("mousemove",this.handleMouseMove),this.stopPropagation(e)},handleMouseMove:function(e){if(this.state.direction){this.clearSelect(),e=e||event;var t=(e.target||e.srcElement,this.getMousePosition(e)),n=this.state.startPosition,o=t.x-n.x,a=t.y-n.y,i=this.state.width,l=this.state.height;switch(this.state.direction){case"nw-resize":i-=o,l-=a;break;case"ne-resize":i+=o,l-=a;break;case"sw-resize":i-=o,l+=a;break;case"se-resize":i+=o,l+=a}n=t,s>i&&(i=s),r>l&&(l=r),this.state.target&&(this.state.target.style.width=i+"px",this.state.target.style.height=l+"px"),this.setState({startPosition:n,width:i,height:l}),this.stopPropagation(e)}},handleMouseUp:function(e){if(this.state.direction){this.clearSelect(),e=e||event;var t=(e.target||e.srcElement,this.getMousePosition(e)),n=this.state.startPosition,o=t.x-n.x,a=t.y-n.y,i=this.state.width,l=this.state.height;switch(this.state.direction){case"nw-resize":i-=o,l-=a;break;case"ne-resize":i+=o,l-=a;break;case"sw-resize":i-=o,l+=a;break;case"se-resize":i+=o,l+=a}n=t,s>i&&(i=s),r>l&&(l=r),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove),this.state.target&&(this.state.target.style.width=i+"px",this.state.target.style.height=l+"px"),this.setState({startPosition:n,height:l,width:i,direction:null}),this.stopPropagation(e)}},render:function(){var e={width:this.state.width,height:this.state.height,left:this.state.position.x,top:this.state.position.y,display:this.state.show?"block":"none",positoin:"absolute"};return o.createElement("div",{className:"editor-resize-container",ref:"root"},o.createElement("div",{className:"editor-resize",style:e},o.createElement("div",{className:"block-resize nw-resize",onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp}),o.createElement("div",{className:"block-resize ne-resize",onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp}),o.createElement("div",{className:"block-resize sw-resize",onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp}),o.createElement("div",{className:"block-resize se-resize",onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp})))}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./EditorDOM":24,"react-dom":void 0}],28:[function(e,t,n){"use strict";var o=e("./EditorDOM");NodeList.prototype.toArray=function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e};var a={range:null,selection:null,storedRange:!1,getSelection:function(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection?document.selection.createRange():null},cloneRange:function(){this.storedRange||(this.selection=this.getSelection(),this.selection.removeAllRanges(),this.selection&&this.range&&(this.selection.addRange(this.range.cloneRange()),this.range=this.range.cloneRange()))},getTextNodes:function(){if(!this.range)return[];if(this.range.collapsed)return[];var e=this.range.commonAncestorContainer,t=this.range.startContainer,n=this.range.startOffset,a=this.range.endContainer,i=this.range.endOffset,s=[];if(t===a&&o.isTextNode(t))s.push({childNode:t,startOffset:n,endOffset:i});else for(var r=e.childNodes.toArray(),l=!1,c=r.shift();c&&(o.isTextNode(c)&&(c===t?(s.push({childNode:c,startOffset:n,endOffset:c.length}),l=!0):c===a?s.push({childNode:c,startOffset:0,endOffset:i}):s.length>0&&s.push({childNode:c,startOffset:0,endOffset:c.length})),c!=a);){var d=c.childNodes.toArray();r=d.concat(r),c=r.shift()}return s},getSpanNodes:function(){if(!this.range)return[];if(this.range.collapsed)return[];var e=this.range.commonAncestorContainer;3==e.nodeType&&(e=e.parentNode);var t=this.range.startContainer,n=this.range.endContainer,a=[];if(o.isSpanNode(e)&&a.push(e),t===n&&o.isSpanNode(t))a.push(t);else for(var i=e.childNodes.toArray(),s=0,r=!1,l=i.shift();l&&(l===t&&(r=!0,o.isSpanNode(l.parentNode)&&a.push(l.parentNode)),o.isSpanNode(l)&&r&&a.push(l),l!=n);){var c=l.childNodes.toArray();i=c.concat(i),l=i.shift()}for(var d=[],s=0;s<a.length;s++)-1==d.indexOf(a[s])&&d.push(a[s]);return d},getParagraphs:function(){for(var e=this.getTextNodes(),t=[],n=0;n<e.length;n++){var o=null,a=e[n].childNode.parentNode.tagName||e[n].childNode.parentNode.nodeName;switch(a.toUpperCase()){case"FONT":o=e[n].childNode.parentNode;break;default:o=e[n].childNode}-1==t.indexOf(o.parentNode)&&t.push(o.parentNode)}return t},getCommonAncestor:function(){if(this.range.collapsed)return null;var e=this.range.commonAncestorContainer;return e},addRange:function(e,t,n,o){this.selection=this.getSelection(),this.selection.removeAllRanges(),this.selection&&this.range&&e instanceof Node&&n instanceof Node&&(this.range.setStart(e,t),this.range.setEnd(n,o),this.selection.addRange(this.range.cloneRange()),this.range=this.range.cloneRange())},createRange:function(){this.storedRange||(this.selection=this.getSelection(),this.selection&&this.selection.rangeCount>0?this.range=this.selection.getRangeAt(0).cloneRange():this.range=null)},clearRange:function(){this.storedRange||(this.selection=this.getSelection(),this.selection.removeAllRanges())},getRangeState:function(){for(var e={},t="bold italic underline strikethrough fontborder superscript subscript justifycenter justifyleft justifyright",n=t.split(" "),o=0;o<n.length;o++)e[n[o]]={icon:n[o],active:!1};if(this.range)for(var a=this.range.startContainer.parentNode;"DIV"!=(a.tagName||a.nodeName).toUpperCase();){var i=a.tagName||a.nodeName;switch(i.toUpperCase()){case"I":e.italic={active:!0,icon:"italic"};break;case"B":e.bold={active:!0,icon:"bold"};break;case"U":e.underline={active:!0,icon:"underline"};break;case"STRIKE":e.strikethrough={active:!0,icon:"strikethrough"};break;case"SUP":e.superscript={active:!0,icon:"superscript"};break;case"SUB":e.subscript={active:!0,icon:"subscript"};break;case"FONT":e.forecolor={color:a.color,icon:"forecolor"},e.backcolor={color:a.style.backgroundColor,icon:"backcolor"},e.fontsize={value:a.size,icon:"fontsize"},e.fontfamily={value:a.face,icon:"fontfamily"};break;case"P":case"H1":case"H2":case"H3":case"H5":case"H6":var s=a.style.textAlign?a.style.textAlign:"left";a.style.fontFamily?a.style.fontFamily:"宋体,SimSun",a.style.fontSize?a.style.fontSize:"12px";e.justifycenter={active:"center"==s,icon:"subscript"},e.justifyleft={active:"left"==s,icon:"subscript"},e.justifyright={active:"right"==s,icon:"subscript"},e.paragraph={value:a.tagName.toLowerCase(),icon:"paragraph"};break;case"BLOCKQUOTE":e.indent={active:!0,icon:"indent"},e.outdent={active:!1,icon:"outdent"};break;case"SPAN":var r=a.className||"";-1!=r.indexOf("font-border")&&(e.fontborder={active:!0,icon:"fontborder"})}a=a.parentNode}return e.forecolor||(e.forecolor={color:"transparent",icon:"forecolor"}),e.backcolor||(e.backcolor={color:"transparent",icon:"backcolor"}),e.fontsize&&e.fontsize.value||(e.fontsize={value:"3",icon:"fontsize"}),e.paragraph&&e.paragraph.value||(e.paragraph={value:"p",icon:"fontsize"}),e.fontfamily&&e.fontfamily.value||(e.fontfamily={value:"宋体, SimSun",icon:"fontfamily"}),e.indent||(e.outdent={active:!0,icon:"outdent"},e.indent={active:!1,icon:"indent"}),e},storeRange:function(){this.storedRange=this.range?this.range.cloneRange():null},restoreRange:function(){this.range=this.storedRange?this.storedRange.cloneRange():null,this.storedRange=null,this.cloneRange()},insertNode:function(e){if(this.range){a.range.insertNode(e);var t=e.lastChild||e;t&&(this.range.setStartAfter(t),this.range.setEndAfter(t)),this.selection.removeAllRanges(),this.selection.addRange(this.range)}}};t.exports=a},{"./EditorDOM":24}],29:[function(e,t,n){"use strict";var o=1e3/60;window.requestAnimationFrame||(window.requestAnimationFrame=function(e){setTimeout(e,o)});var a=[],i=[],s=[],r=!1,l=0,c={addCount:function(){l+=1},setTimeout:function(e,t){return e.prototype.ms=t?t:o,e.prototype.key="timeout"+(new Date).valueOf()+"-"+Math.round(1e3*Math.random()),e.prototype.startTime=(new Date).valueOf(),e.prototype.endTime=(new Date).valueOf(),a.push(e),e.prototype.key},clearTimeout:function(e){var t=a.filter(function(t,n){return t.prototype.key==e});if(t.length>0){var n=a.indexOf(t[0]);return-1!=n&&(a.disabled=!0),t[0]}return null},setInterval:function(e,t){return e.prototype.ms=t?t:o,e.prototype.key="interval"+(new Date).valueOf()+"-"+Math.round(1e3*Math.random()),e.prototype.startTime=(new Date).valueOf(),e.prototype.endTime=(new Date).valueOf(),e.prototype.lastTime=(new Date).valueOf(),i.push(e),e.prototype.key},clearInterval:function(e){var t=i.filter(function(t,n){return t.prototype.key==e});if(t.length>0){var n=i.indexOf(t[0]);return-1!=n&&(i.disabled=!0),t[0]}return null},animate:function(e){if(window.requestAnimationFrame(c.animate),r){for(var t=0;t<s.length;t++)s[t]({count:l});c.addCount()}for(var t=0;t<a.length;t++)a[t].prototype.endTime=(new Date).valueOf(),a[t].prototype.endTime-a[t].prototype.startTime>=a[t].prototype.ms&&!a[t].prototype.disabled&&(a[t].prototype.disabled=!0,a[t].call(a[t].prototype,a[t].prototype.endTime));for(var t=0;t<i.length;t++)i[t].prototype.endTime=(new Date).valueOf(),i[t].prototype.endTime-i[t].prototype.lastTime>=i[t].prototype.ms&&!i[t].prototype.disabled&&(i[t].prototype.lastTime=i[t].prototype.endTime,i[t].call(i[t].prototype,i[t].prototype.endTime));a=a.filter(function(e,t){return!e.prototype.disabled}),i=i.filter(function(e,t){return!e.prototype.disabled})},startAnimation:function(){r=!0},stopAnimation:function(){r=!1},addAnimationHandler:function(e){var t=r;c.stopAnimation(e),window.requestAnimationFrame(function(){s.push(e),t&&c.startAnimation(e)})},removeAnimationHandler:function(e){var t=r;c.stopAnimation(e),window.requestAnimationFrame(function(){var n=s.indexOf(e);-1!=n&&s.splice(e,n),t&&c.startAnimation(e)})}};c.animate(),t.exports=c},{}],30:[function(e,t,n){"use strict";var o=e("./QiniuUtils"),a=function(e,t){var n="cannot post "+e.url+":"+t.status,o=new Error(n);return o.status=t.status,o.method="post",o.url=e.url,o},i=function(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(n){return t}},s={post:function(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onLoad(t)});var n=new FormData;if(e.data)for(var s in e.data)n.append(s,e.data[s]);if("qiniu"==e.type){var r=e.qiniu.key||e.qiniu.genKey(e);n.append("token",e.qiniu.upload_token?e.qiniu.upload_token:o.Utils.genUploadToken(r,e.qiniu.app)),e.qiniu.key&&n.append("key",e.qiniu.key),e.filename="file"}n.append(e.filename,e.file),t.onerror=function(t){e.onEnd(t),e.onError(t)},t.onload=function(n){if(200!==t.status)return e.onEnd(n),e.onError(a(e,t),i(t));if(e.onEnd(n),"qiniu"==e.type){var o=i(t),s={status:"success",data:{image_src:e.qiniu.domain+"/"+o.key}};e.onSuccess(s)}else e.onSuccess(i(t))},t.open("post",e.url,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send(n)}}};t.exports={uploadFile:function(e){e.url=e.url||"/upload",e.filename=e.filename||"file",e.beforeUpload=e.beforeUpload||function(e){return!0},e.onSuccess=e.onSuccess||function(e){},e.onError=e.onError||function(e){},e.onLoad=e.onLoad||function(e){},e.onStart=e.onStart||function(e){},e.onEnd=e.onEnd||function(e){},e.beforeUpload(e)&&(e.onStart(e),s.post(e))},uploadFiles:function(e){}}},{"./QiniuUtils":31}],31:[function(e,t,n){"use strict";var o=e("hmacsha1"),a={Bucket:"qtestbucket",AK:"iN7NgwM31j4-BZacMjPrOQBs34UG1maYCAQmhdCV",SK:"6QTOr2Jg1gcZEWDQXKOGZh5PziC2MCV5KsntT70j"},i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",s={utf16to8:function(e){var t,n,o,a;for(t="",o=e.length,n=0;o>n;n++)a=e.charCodeAt(n),a>=1&&127>=a?t+=e.charAt(n):a>2047?(t+=String.fromCharCode(224|a>>12&15),t+=String.fromCharCode(128|a>>6&63),t+=String.fromCharCode(128|a>>0&63)):(t+=String.fromCharCode(192|a>>6&31),t+=String.fromCharCode(128|a>>0&63));return t},utf8to16:function(e){var t,n,o,a,i,s;for(t="",o=e.length,n=0;o>n;)switch(a=e.charCodeAt(n++),a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(n-1);break;case 12:case 13:i=e.charCodeAt(n++),t+=String.fromCharCode((31&a)<<6|63&i);break;case 14:i=e.charCodeAt(n++),s=e.charCodeAt(n++),t+=String.fromCharCode((15&a)<<12|(63&i)<<6|(63&s)<<0)}return t},base64encode:function(e){var t,n,o,a,s,r;for(o=e.length,n=0,t="";o>n;){if(a=255&e.charCodeAt(n++),n==o){t+=i.charAt(a>>2),t+=i.charAt((3&a)<<4),t+="==";break}if(s=e.charCodeAt(n++),n==o){t+=i.charAt(a>>2),t+=i.charAt((3&a)<<4|(240&s)>>4),t+=i.charAt((15&s)<<2),t+="=";break}r=e.charCodeAt(n++),t+=i.charAt(a>>2),t+=i.charAt((3&a)<<4|(240&s)>>4),t+=i.charAt((15&s)<<2|(192&r)>>6),t+=i.charAt(63&r)}return t},safe64:function(e){return e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_")}},r={genPutPolicy:function(e,t,n,o){return{scope:t?e:e+":"+t,deadline:n?n:(new Date).valueOf()+86400,returnBody:o?o:'{"key": $(key), "hash": $(etag), "w": $(imageInfo.width), "h": $(imageInfo.height)}'}},genToken:function(e,t,n){var a=JSON.stringify(n);console.log("put_policy = ",a);var i=s.base64encode(s.utf16to8(a));console.log("encoded = ",i);var r=o(t,i);console.log("encoded_signed = ",r);var l=e+":"+s.safe64(r)+":"+i;return console.log("upload_token = ",l),l},genUploadToken:function(e,t){var t=t?t:a;return r.genToken(t.AK,t.SK,r.genPutPolicy(t.Bucket,e))}};t.exports={Utils:r}},{hmacsha1:1}]},{},[23])(23)});